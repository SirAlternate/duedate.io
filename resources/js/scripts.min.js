$(function(){if($("body").attr("id")=="dashboard"){var b=$(".add-class-btn");var a=$();if($(".display").children().length==2){show_class_form()}$("body").on("submit",".display .new form.add-class",function(c){c.preventDefault();$.post("resources/library/actions.php",{action:"add",type:"class",data:{name:$(this).find("input[name='class_name']").val(),desc:$(this).find("input[name='class_desc']").val(),color:$(this).find(".colors input:checked").val()}},function(d){if(d==true){location.reload()}})});$("body").on("mouseup",".display .new form.add-class .colors",function(d){var c=$(d.target).attr("for");$(d.target).closest(".new").attr("color",c)});$("body").on("click",".add-class-btn",function(c){show_class_form()});$("body").on("click",".display .new .close-btn",function(c){hide_class_form()});$("body").on("click",".display .class .close-btn",function(d){d.preventDefault();var c=$(d.target).parent().parent().attr("class-id");$.post("resources/library/actions.php",{action:"delete",type:"class",id:c},function(e){if(e==true){$(d.target).parent().parent().remove();if($(".display").children().length==2){show_form()}}return false})});$("body").on("click",".display .class ul li.add-btn",function(d){var c=$(d.target).closest("li");if(c.hasClass("selected")){hide_assignment_form(c)}else{close_all_assignments();hide_all_assignment_forms();show_assignment_form(c);c.parent().delay(100).animate({scrollTop:c.parent().height()},300)}});$("body").on("click",".display .class ul li.item",function(h){var f=$(h.target).closest("li");hide_all_assignment_forms();if(f.hasClass("selected")){close_assignment(f)}else{if(f.parent().find("li.item.selected").length>0){var d=f.parent().find("li.item.selected");var c=d.attr("assg-id");var g=$('.display .assignment[assg-id="'+c+'"]');open_assignment(f,g);d.removeClass("selected")}else{close_all_assignments(function(){open_assignment(f)})}}});$("body").on("submit",".display .class form.add-assignment",function(c){c.preventDefault();$.post("resources/library/actions.php",{action:"add",type:"assignment",data:{class_id:$(this).parent().parent().attr("class-id"),title:$(this).find("input[name='assg_title']").val(),due_date:$(this).find("input[name='assg_due']").val(),desc:$(this).find("input[name='assg_desc']").val()}},function(d){if(d==true){location.reload()}})})}});function show_class_form(){var b=$(".add-class-btn");var a=$("form.add-class");b.attr("hide","true");a.parent().attr("hide","false");b.after(a.parent());a.find('input[name="class_name"]').focus();$(".display").scrollLeft($(".display").width())}function hide_class_form(){var b=$(".add-class-btn");var a=$("form.add-class");a.parent().attr("hide","true");b.attr("hide","false");a.parent().after(b);a.find('input[name="class_name"]').val("");a.find('input[name="class_desc"]').val("");a.parent().removeAttr("color")}function open_assignment(b,a){$.get("resources/library/actions.php",{type:"assignment",id:b.attr("assg-id")},function(d){var e=$.parseJSON(d);if(e){if(a==undefined){b.closest(".class").after('                    <div class="assignment" assg-id="'+b.attr("assg-id")+'" hide="true">                        <h1>'+e.title+"</h1>                    </div>                ")}else{a.replaceWith('                    <div class="assignment" assg-id="'+b.attr("assg-id")+'" hide="false">                        <h1>'+e.title+"</h1>                    </div>                ")}var c=$('.assignment[assg-id="'+b.attr("assg-id")+'"]');if(c.hasClass("assignment")){c.focus().attr("hide","false")}b.addClass("selected")}})}function close_assignment(c,a){var b=$('.assignment[assg-id="'+c.attr("assg-id")+'"]');b.attr("hide","true").delay(300).hide(0,function(){$(this).remove();if(typeof a==="function"){a()}});c.removeClass("selected")}function close_all_assignments(a){var b=$(".display").find("ul li.item.selected");close_assignment(b,function(){if(typeof a==="function"){a()}});if(b.length==0&&typeof a==="function"){a()}}function show_assignment_form(a){a.addClass("selected");a.find("span").text("-");a.parent().find("form.add-assignment").attr("hide","false")}function hide_assignment_form(a){a.removeClass("selected");a.find("span").text("+");a.parent().find("form.add-assignment").attr("hide","true");a.parent().find('input[name="assg_title"]').val("");a.parent().find('input[name="assg_due"]').val("");a.parent().find('input[name="assg_desc"]').val("")}function hide_all_assignment_forms(){var a=$(".display .class .add-btn.selected");hide_assignment_form(a)};